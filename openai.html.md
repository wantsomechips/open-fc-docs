# OpenAI Function Calling Implementation


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Import Required Modules

This notebook requires `os` and `dotenv` to load the environment
variables, self-defined `logger` to access the log system, core funciton
[`add`](https://wantsomechips.github.io/openai-fc/core.html#add) and
OpenAI’s asynchronous client, `json` to handle the OepnAI’s response.

## Load Enviroment Variables and Set Global variables.

Load environment variables regarding OpenAI.

### Code Note

Enable `override` to keep variables updated.

Variables with a name comprised of all capital letters should be
constant:

- `INS_ADD`: OpenAI instruction for
  [`add`](https://wantsomechips.github.io/openai-fc/core.html#add).
- `TOOLS`: OpenAI tools schema.
- `FUNCS`: Functions used in `TOOLS`, via this we can directly call the
  functions involved in response.

Use the global variable `async_openai_client` to ensure that the OpenAI
client is initialized only once. This is time efficient.

IMPORTANT:

DocmentTbl of nbdev needs at least one parameter.

For examples:

``` python
def test() -> int # Interger.
```

won’t have a parameter table in the final `nbdev_preview`.

``` python
def test(placeholder:int = None # Placeholder, no effect
        ) -> int # Interger.
```

will successfully show the parameter table.

This might be a bug.

## Implements OpenAI Function Calling Chatbot

Implements an asynchronous OpenAI chatbot, and returns response text.

Note that asynchronous concurrent execution is much faster than
sequential execution, and it suits the `discord.py` module. It’s a good
choice.

### Code Note

OpenAI reasoning models (name started with “o”, E.g. “o3-mini”) has
different api and response compared to normal models (name started with
“gpt”, E.g. “gpt-4o”).

Compared to normal models, reasoning models haven’t `temperature`
parameter and first element of their response (`resp.output[0]`) is
reasoning details rather than OpenAI’s `function_call` (starting from
`resp.output[1]`), which indicates “id”, “call_id”, “type”, “name” and
“arguments” of called funcitons.

------------------------------------------------------------------------

<a
href="https://github.com/wantsomechips/openai-fc/blob/main/openai_fc/openai_fc.py#L81"
target="_blank" style="float:right; font-size:smaller">source</a>

### async_chat_bot

>  async_chat_bot (query:str)

*Process user’s inputs and return the response text.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>query</td>
<td>str</td>
<td>User’s input.</td>
</tr>
<tr>
<td><strong>Returns</strong></td>
<td><strong>str</strong></td>
<td><strong>Response text from OpenAI model.</strong></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/wantsomechips/openai-fc/blob/main/openai_fc/openai_fc.py#L59"
target="_blank" style="float:right; font-size:smaller">source</a>

### get_async_openai_client

>  get_async_openai_client ()

*Get Asynchronous OpenAI client. Maek sure the client only initialize
once.*
